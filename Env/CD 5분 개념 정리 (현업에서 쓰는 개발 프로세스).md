- 요즘같이 빠르게 지나고 변하는 시대에 어떻게 하면 시장과 고객의 요구에 빠르게 반응해서 제품을 출시 업데이트 할 것인가가 큰 과제

- 바로 이것을 위해서 세계적으로 많은 기업들이 CI/CD를 개발 프로세스로 사용하고 있다.

- 대부분의 회사에서 CI/CD 환경에서 일하고 있기 때문에 개발자거 소프트웨어 제품에 관련된 일을 한다면 CI/CD가 정확하게 뭔지 이해하는 것이 좋다

<br/>

## CI/CD

- CI/CD란 간단하게 말해서 어플리케이션 개발 단계부터 배포 때까지 이 모든 단계들을 자동화를 통해서 조금 더 효율적이고 빠르게 해 사용자에게 빈번히 배포할 수 있도록 만드는 것을 말한다.

### CI

  - Continuous Intergration
    
  - 지속적인 통합의 약자
  
### CD

  - Continuous Delivery
    
  - 지속적인 제공의 약자
    
  - Delivery 대신에 Deployment, 배포로 사용하는 경우도 있다.

<br/>

## CI

- 버그 수정이나 새로 만드는 기능들이 메인 레포지 토리에 주기적으로 빌드 내고 테스트가 되어서 머지 되는 것을 말한다
  
- 이 방식은 1991년 Grady Booch 에 의해 처음으로 사용되어 지다가 나중에는 Extreme Programming 프로그래밍 개발 방법론 에서 채택되어 졌다.
  
- Grady는 객체지향 프로그래밍에 관련된 아주 유명한 책을 쓴 저자

- CI는 아래 두 가지를 포인트로 잡고 생각하면 정말 좋다.

### 1. 개발자들은 그들의 코드 변경 사항을 메인 레포지토리의 주기적으로 빈번하게 머지를 해야 한다.

- 동일한 소스파일 위해서 두 명의 개발자가 오랜 시간 서로 다른 코드를 작성하고 있다가 나중에 머지를 하려고 하면 서로 다른 코드를 어떻게 통합해서 적용해 나갈 건지 고생을 많이 할 것이다

- 이렇게 되면 새로운 기능을 개발하기 위해서 코드를 작성하는 시간보다 머지 충돌을 해결하기 위해서 더 많은 시간을 사용해야 할 수도 있다.

- 그렇기 때문에 버그를 수정하거나 또는 새로운 기능을 구현할 때는 더더욱 기능을 어떻게 작은 단위로 나눠서 메인 레포지토리에 반영하거나 또는 작은 단위로 나눠서 사용자에게 배포할 수 있을지 고민하면서 최대한 작은 단위로 나누어서 개발하고 통합해 나가는 것이 중요하다.

### 2. 통합을 위한 단계(빌드, 테스트, 머지)의 자동화

- 코드 작성 -> Repository -> (Build, Test) -> CI Server

- 더 중요한 두 번째 포인트는, 주기적으로 머지된 코드의 변경 사항이 자동으로 빌드가 되어서 코드 변경 사항 이후에도 빌드가 성공적으로 되는지 확인이 되어야 한다.

- 그리고 새로 추가된 이 코드의 변경사항 뿐만 아니라 기존의 시스템의 다른 버그를 초래 하지는 않았는지 자동으로 테스트까지 되어야 한다.

- 보통 개발팀에서 이런식으로 셋업을 많이 한다

  - 메인 레포지토리가 있고 개발자들은 하루에도 몇 번씩 주기적으로 코드의 변경사항을 메인 레포지토리에 머지를 한다.

  - 물론 그 전에 코드 리뷰를 통해서코드가 적절한 지 확인을 받아야한다.

  - 이렇게 머지가 되었으면 자동으로 팀에서 만든 CI 스크립트를 통해서 추가된 코드와 함께 이 레포지토리가 빌드가 되고 빌드가 잘 된다면 팀에서 작성한 유닛테스트, 통합테스트 등등 여러가지 테스트들도 스크립트를 통해서 실행이 된다.

  - 이렇게 빌드도 잘되고 테스트가 잘 되어서 Green 이라는 초록색 사인이 나오면 무사히 통과가 되어서 나중에 배포할 때 반영이 될 수 있다

  - 새로 추가된 코드에 문제가 있어서 빌드가 실패하거나 또는 빌드는 성공했는데 테스트에서 실패한다면 빨간색 Red 싸인이 뜨면서 뜨면서 문제를 일으킨 개발자에게 자동으로 알려준다.

- 이렇게 CI 원칙을 따라갔을 때 장점들은 주기적으로 머지를 하기 때문에 충돌을 피할 수 있어서 개발의 생산성을 더 높일 수 있고 머지되는 모든 코드들은 자동으로 빌드 되고 테스트 되기 때문에 코드의 결함이나 문제점이 빠르게 발견될 수 있다

- 그리고 이렇게 발생되는 결함은 빠르게 수정이 가능하다는 장점이 있다.

- 왜냐하면 주기적으로 머지를 하기 위해서 코드의 변경 사항이 작기 때문에 문제를 수정할 때도 조금 더 고립된 작은 단위의 문제를 확인할 수 있기 때문이다.

- 그리고 마지막 최강의 장점은 바로 이런 것들 통해서 조금 더 나은 코드의 퀄리티를 가질 수 있다는 것

- 왜냐하면 이렇게 CI를 잘 운영하기 위해서는 모든 개발자들이 자신이 새로 작성하는 코드에 한해서는 유니테스트 를 꼭 포함해야 하기 때문이다.

- 그래서 CI 를 사용한다면 우리 프로젝트의 대부분의 소스 코드들이 자동으로 테스트가 될 수 있도록 만들기 때문에 조금 더 안정성 있는 제품을 개발해 나갈 수 있다

---

## CD

- Continuous Delivery 또는 Continuous Deployment
  
- 각각 서로 연관이 있고 또 함께 섞어서 사용하는 경우가 있기 때문에 비슷하다고 보면 된다

- 지속적 제공 지속적 배포 이 두 가지 모두 다 마지막 배포 단계에서 어떻게 하면 자동화해서 배포를 할 수 있을지를 고민하는 단계

- CI 를 통해서 주기적으로 머지된 코드의 변경 사항들이 자동으로 빌드가 되고 테스트가 되었다면 이제 배포 하는 단계에서 배포할 즉, 릴리즈 할 준비 과정(Prepare Release)을 거치고

- 여기에서 준비된 릴리즈가 괜찮은지, 정상적인지 아무런 문제가 없는지 직접 개발자나 또는 검증 팀이 검증을 한 다음에 최종적으로 사용자에게 배포 해도 되겠다라고 결정이 되면 수동적으로 배포하는 이 단계(DEPLOY RELEASE)를 Continuous Delivery 라고 한다.

- 또는 릴리즈가 준비가 되자마자 자동으로 후 사용자에게 배포할 수 있도록 만들 수도 있는데 이렇게 모든 과정을 자동화 해놓는 것을 Continuous Deployment 라고 한다.

- Delivery 와 살짝 비슷하지만 최종 단계가 자동화가 되었는지 되지 않았는지 에 따라서 살짝씩 달라질 수 있다

- 이런 모든 과정들을 어떻게 자동화를 하는지, 어떻게 스크립트를 쓰는지 그리고 이 자동화와 테스팅에 대해서 얼마나 자신감이 있느냐에 따라서 어떤 회사들은 최종 단계는 수동적으로 릴리즈하는 경우가 있고 또 어떤 회사는 Continuous Deployment 사용하는 경우도 있다.

- 회사마다 어느 정도의 얼마만큼의 자동화를 하는지가 달라지기 때문에 CI/CD 라고 해서 모든 회사가 똑같은 프로세스를 거치는 것은 아니고 회사마다 팀마다 다른 방식으로 적용해서 사용할 수 있다.

- 앞에서 살펴본 것처럼 CI와 CD가 완벽히 분리된 것이 아니라 대부분의 회사에서 CI와 CD를 거쳐서 배포를 하기 때문에 CI/CD 이렇게 묶어서 부르곤 한다.

- CI/CD 파이프라인을 한번 더 정리해 보면 개발자가 작은 단위로 기능을 나누어서 주기적으로 메인 레포지토리에 머지를 하면 자동으로 빌드를 하고 테스트 과정을 거쳐서 릴리즈 준비를 하고 여기서 수동적으로 또는자동으로 최종 배포를 거치게 된다.

  - CODE -> BUILD -> TEST -> RELEASE -> DEPLOY

- CI/CD를 위한 다양한 툴들이 있는데 GitLab CI/CD, Jenkins, BuildKite, GitHub Actions, Bitbucket Pipelines, circleci 등 다양한 툴들이 있다

---

## Reference

- [CI/CD 5분 개념 정리 (현업에서 쓰는 개발 프로세스)](https://www.youtube.com/watch?v=0Emq5FypiMM)
