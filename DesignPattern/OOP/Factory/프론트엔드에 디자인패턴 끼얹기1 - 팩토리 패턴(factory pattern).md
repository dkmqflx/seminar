# Factory Pattern

## 디자인 패턴이란 ?

- 프로그래밍 세계에서 디자인패턴은 개발을 할 때 발생하는 유사한 문제점에 대한 일련의 해결방식을 정의해놓은 것입니다

- 일종의 수학의 정석과 같다고 할 수 있지요

- 개발 트랜드는 시대나 분야, 언어나 환경에 따라 변화하지만 디자인 패턴은 여전히 유효합니다

- 10년 전이나 지금이나 코드를 어렵게 만드는 요소들은 여전히 같은 맥락을 이어가니까요

- 그래서 디자인 패턴의 핵심은 각 패턴이 어떤 문제를 해결하기 위해서 어떤 아이디어를 사용했는지에 대해 이해하는 것이고

- 이에 대한 통찰을 넓혀갈수록 실제 상황에서 유사한 문제를 만났을때 슬기롭게 해결해나가실 수 있을 것입니다

- 그리고 패턴 자체에 어느정도 맥락이 공유되기 때문에 커뮤니케이션 비용을 아낄 수 있는 효과도 있습니다

## 팩토리 패턴이란?

- 이번 영상에서는 고전 디자인 패턴 중 하나인 팩토리 패턴에 대해 이야기 해볼게요

- 팩토리는 넓은 범위에서 보면 객체, 함수, 값을 반환하는 함수로

- 특정 상황에 어떤 **객체, 값, 함수**를 사용할지에 대한 구체적인 로직을 추상화하고 관련된 로직을 하나의 함수로 응집할 수 있게 도와줍니다

- 좀 더 예를 들어볼까요? 어떤 프로젝트 안에 A, B, C라는 컴포넌트가 있다고 가정할게요

- 그런데 각 컴포넌트에 덧셈 기능을 넣어달라는 요구사항이 들어온거에요

- 그래서 덧셈 기능을 만들기 시작했는데

- 각 컴포넌트에서 직접 기능을 구현할 수 있지만, 이 녀석을 재사용 하기위해 별도의 모듈로 분리해두었죠

- 여기까지는 군더더기 없어보여요

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/01.png'>

<br/>

- 며칠 뒤에 새로운 태스크를 진행하는데, 이번에는 이진수 덧셈이 가능해야된다네요?

- 자 그럼 새로운 모듈을 추가해서 이진수 덧셈 함수를 구현하고

- if 문을 활용해서 각 컴포넌트에서 조건에 따라 계산을 수행하게 해볼게요

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/02.png'>

- 아 근데 또 며칠 뒤에 팔진수 덧셈이 가능하게 만들어야 한다네요?

- 자 이번에도 새로운 모듈을 만들어서..

- 팔진수 함수를 구현하고..

- 각 컴포넌트에 조건을 추가해서..

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/03.png'>

- 아 이게 맞나..? 라고 생각이 들때가 바로 팩토리 패턴을 적용하기 위한 적기입니다

- 여태까지 작업한 내용을 자세히보면 비슷한 맥락을 갖는 행위들이 조건에 따라서 조금씩 차이가 나는 것을 볼 수 있는데요

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/04.png'>

- 이런식으로 어떤 맥락에 따라서 어떤 행위를 해야하는지에 대한 부분을 별도의 함수로 분리할 수 있습니다

- 이 함수가 바로 팩토리가 되는것이에요

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/05.png'>

- 이 경우에는 특정 타입에 따라서 적절한 진수 덧셈 함수를 반환하도록 분기시켜줄 수 있겠죠

- 그리고 각 컴포넌트에서 분기에 따른 구현을 직접 정의하지 않고 팩토리를 사용하도록 하는 것이죠

- 그래서 결론적으로 스펙이 변경될때마다 각 컴포넌트의 맥락을 전부 수정해줘야했던 부분을 팩토리가 담당할 수 있도록 하여 응집도가 높은 구조를 갖게 해주는 거에요

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/06.png'>

<br/>

- 비단 이런 로직들 뿐만아니라 컴포넌트 스펙에서도 이런 경우가 종종 있는데요

- 간단하게는 주문 상태별로 버튼이 다르게 동작해야한다든지,

- 혹은 이벤트 배너의 문구가 다르게 노출되어야 한다든지

- 이런 경우를 들 수 있을 것 같아요

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/07.png'>

<br/>

- 특히 이런 맥락에 따른 기능이 여러 컴포넌트에 흩어져있는 경우에는 스펙이 변경될 경우 여러 컴포넌트를 손봐야 할 수 있는데

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/08.png'>

<br/>

- 이런 경우에도 마찬가지로, 각 케이스 별로 어떤 조건에, 어떤 동작이 되어야하는지를 하나의 팩토리에 정의하는 것을 시도해볼 수 있어요

- 단순히 조건에 따른 기능분기 역할 뿐만아니라 도메인에 따른 기능 정의를 '응집하는 용도'로 사용 가능하다는 뜻이죠

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/09.png'>

<br/>

- 어떤 이들은 custom hook 안에서 이미 조건에 따른 동작을 구현해두셨을 수 있는데,

- 이 경우에는 hook이 이미 팩토리 역할을 하고있는 셈이고요

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/10.png'>

<br/>

- 좀 더 넓은 범위에서 보면 화면에 보이는 이런 문구 뿐만아니라 컴포넌트 수준에서도 적용이 가능해요

- 특히 리액트의 컴포넌트는 함수 그 자체기 때문에 왼쪽처럼 컴포넌트 수준의 팩토리

- 혹은 오른쪽처럼 컴포넌트 생성 함수 수준의 팩토리로도 응용할 수 있다는 것이죠

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/11.png'>

<br/>

- 물론 이 경우에 타입스크립트를 사용하고 있다면 props에 대한 인터페이스를 맞춰주는것 또한 고민이 필요할거에요

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/12.png'>

<br/>

- 팩토리 패턴을 얼마나 어떻게 응용할지는 여러분의 상상력에 달려있습니다!

- 말하다보니 생각난건데 저는 최근에, 도메인 주도 설계 관점에서 말하는 aggregate 수준의 스펙을 context로 구현하고

- 일종의 headless처럼 세부 스펙은 컴포넌트 안에 응집시켜 노출하지 않고 실제 페이지 컴포넌트에서는 레이아웃만 처리하는 설계 실험을 진행하고있는데 좀 더 다듬어지면 공유해보도록 하겠습니다

<img src='./images/프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)/13.png'>

- 이번 영상에서는 팩토리 패턴이 조건에 따라 달라지는 비슷한 맥락을 갖는 행위를 한 곳에 응집시킬 수 있는 아이디어라는것을 알 수 있었습니다

- 물론 단순히 조건문이 있다는 이유로 전혀 다른 맥락을 갖는 행위들을 팩토리화 한다거나

- 유사한 맥락을 갖는 행위를 무조건 하나의 팩토리에 몰아넣으면 오히려 팩토리 자체에 의존적이게되어 팩토리를 수정했을때 생기는 사이드 이팩트를 감당할 수 없게되는 위험성도 있으니

- 이 수준을 어느 정도로 조절할지는 여러분이 직접 고민해보시면 좋을 것 같습니다

---

## Reference

- [프론트엔드에 디자인패턴 끼얹기1 - 팩토리 패턴(factory pattern)](https://www.youtube.com/watch?v=eSLrZbPHgoI)

- [팩토리 패턴(factory pattern)에 대한 생각](https://yuddomack.tistory.com/entry/%ED%8C%A9%ED%86%A0%EB%A6%AC-%ED%8C%A8%ED%84%B4factory-pattern%EC%97%90-%EB%8C%80%ED%95%9C-%EC%83%9D%EA%B0%81)
